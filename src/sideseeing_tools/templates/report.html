<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Plotly.js for charts -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- Leaflet for maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="static/css/custom.css">
</head>
<body class="bg-gray-50 text-slate-800 flex h-screen overflow-hidden">

    <!-- Mobile Overlay -->
    <div id="mobile-overlay" class="fixed inset-0 bg-black/50 z-30 hidden lg:hidden"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed lg:relative top-0 left-0 h-full w-64 bg-slate-900 text-white z-40 transition-transform duration-300 ease-in-out -translate-x-full lg:translate-x-0 flex flex-col">
        <div class="p-6 border-b border-slate-700 flex items-center justify-between">
            <div>
                <div class="font-bold text-xl">SideSeeing</div>
                <div class="text-sm text-gray-500">Report</div>
            </div>
            <button id="sidebar-close-btn" class="lg:hidden text-slate-400 hover:text-white">
                <i data-lucide="x"></i>
            </button>
        </div>

        <nav class="p-4 space-y-2 flex-1 overflow-y-auto sidebar-scrollbar">
            <!-- Dataset Section -->
            <div class="pt-0">
                <button class="menu-toggle w-full flex justify-between items-center px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider" data-target="submenu-dataset">
                    <span>Dataset</span>
                    <i data-lucide="chevron-down" size="16" class="menu-toggle-icon"></i>
                </button>
                <div id="submenu-dataset" class="submenu mt-2 space-y-1">
                    <a href="#" data-section="summary" class="nav-link flex items-center gap-3 px-4 py-3 bg-blue-600 text-white shadow-lg shadow-blue-900/50 rounded-lg transition-all">
                        <i data-lucide="bar-chart-3" size="18"></i>
                        <span class="font-medium text-sm">Summary</span>
                    </a>
                    <a href="#" data-section="geo" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all">
                        <i data-lucide="map-pin" size="18"></i><span class="font-medium text-sm">Geolocation</span>
                    </a>
                    <a href="#" data-section="sensors" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all">
                        <i data-lucide="activity" size="18"></i><span class="font-medium text-sm">Device Sensors</span>
                    </a>
                    <a href="#" data-section="wifi" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all">
                        <i data-lucide="wifi" size="18"></i><span class="font-medium text-sm">Wi-Fi Signals</span>
                    </a>
                    <a href="#" data-section="cell" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-600 rounded-lg cursor-not-allowed opacity-75">
                        <i data-lucide="radio-tower" size="18"></i><span class="font-medium text-sm">Cell Network Signals</span>
                    </a>
                    <a href="#" data-section="video" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-600 rounded-lg cursor-not-allowed opacity-75">
                        <i data-lucide="video" size="18"></i><span class="font-medium text-sm">Video Frames</span>
                    </a>
                    <a href="#" data-section="anonymization" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-600 rounded-lg cursor-not-allowed opacity-75">
                        <i data-lucide="hat-glasses" size="18"></i><span class="font-medium text-sm">Anonymization</span>
                    </a>
                </div>
            </div>

            <!-- Analysis Section -->
            <div class="pt-0">
                <button class="menu-toggle w-full flex justify-between items-center px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider" data-target="submenu-analysis">
                    <span>Analysis</span>
                    <i data-lucide="chevron-down" size="16" class="menu-toggle-icon"></i>
                </button>
                <div id="submenu-analysis" class="submenu mt-2 space-y-1">
                    <a href="#" data-section="sidewalk-assessment" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all">
                        <i data-lucide="cpu" size="18"></i><span class="font-medium text-sm">Sidewalk Assessment</span>
                    </a>
                </div>
            </div>

            <!-- Resources Section -->
            <div class="pt-0">
                <button class="menu-toggle w-full flex justify-between items-center px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider" data-target="submenu-resources">
                    <span>Resources</span>
                    <i data-lucide="chevron-down" size="16" class="menu-toggle-icon"></i>
                </button>
                <div id="submenu-resources" class="submenu mt-2 space-y-1">
                    <a href="#" data-section="protocol" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-600 rounded-lg cursor-not-allowed opacity-75">
                        <i data-lucide="clipboard-list" size="18"></i><span class="font-medium text-sm">Collection Protocol</span>
                    </a>
                    <a href="#" data-section="docs" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-600 rounded-lg cursor-not-allowed opacity-75">
                        <i data-lucide="book-open" size="18"></i><span class="font-medium text-sm">Documentation</span>
                    </a>
                    <a href="#" data-section="about" class="nav-link flex items-center gap-3 px-4 py-3 text-slate-600 rounded-lg cursor-not-allowed opacity-75">
                        <i data-lucide="info" size="18"></i><span class="font-medium text-sm">About</span>
                    </a>
                    <a href="https://sites.usp.br/sideseeing" target="_blank" class="flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all">
                        <i data-lucide="external-link" size="18"></i><span class="font-medium text-sm">SideSeeing Portal</span>
                    </a>
                </div>
            </div>
        </nav>

        <div class="p-6 border-t border-slate-800 text-xs text-slate-500">
            <p>Generated on: <span>{{ generation_date }}</span></p>
            <p>Version: <span>{{ version }}</span></p>
            <p class="mt-1">SideSeeing Team - IME/USP</p>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col min-w-0 h-full">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between sticky top-0 z-10 shrink-0">
            <div class="flex items-center gap-4 min-w-0">
                <button id="sidebar-open-btn" class="lg:hidden text-gray-500 hover:text-gray-700">
                    <i data-lucide="menu"></i>
                </button>
                <h1 class="text-xl font-semibold text-gray-800">{{ title }}</h1>
            </div>
            <div class="hidden md:flex items-center gap-4 text-sm text-gray-500 ml-4">
                <div class="flex items-center gap-2">
                    <span>Generated on: {{ generation_date }}</span>
                    <span class="inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 inset-ring inset-ring-blue-700/10">V{{ version }}</span>
                </div>
            </div>
        </header>

        <!-- Scrollable Content Area -->
        <div class="flex-1 overflow-auto p-6 lg:p-10 custom-scrollbar">
            
            {% include 'summary.html' %}

            {% include 'geo.html' %}

            {% include 'sensor.html' %}

            {% include 'wifi.html' %}

            {% include 'cell.html' %}

            {% include 'video.html' %}

            {% include 'sidewalk-assessment.html' %}
            
        </div>
    </main>

    <script>
        const SAMPLES_DATA = {{ summary.sample_details | tojson }};
        const SENSOR_FILES = {{ sections.sensor | tojson }};
        const GEO_FILES = {{ sections.geo | tojson }};
        const GEO_CENTERS_DATA = {{ summary.geo_centers_map | tojson }};
    </script>
    <script src="static/js/map_utils.js"></script>
    <script src="static/js/summary.js"></script>
    <script src="static/js/sidewalk_assessment.js"></script>
    <script src="static/js/geo.js"></script>
    <script src="static/js/sensor.js"></script>
    <script src="static/js/wifi.js"></script>
    <script src="static/js/custom.js"></script>
    <script src="static/js/simple_sections.js"></script>
</body>
</html>